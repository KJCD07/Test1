SELECT DISTINCT pq.* -- Replace pq.* with actual columns needed for ProductQueue
FROM ARNG_IP ip
INNER JOIN CSTs p ON ip.PTY_ID = p.PTY_ID
INNER JOIN ARNGs a ON ip.ARNG_ID = a.ARNG_ID
WHERE 
    ip.DEL_FL IS NOT NULL AND ip.DEL_FL = 0
    AND a.DEL_FL IS NOT NULL AND a.DEL_FL = 0
    AND p.DEL_FL IS NOT NULL AND p.DEL_FL = 0
    AND (a.ARNG_STAT_ID = CAST(@ArngstatusPendingClosure AS INT) 
         OR a.ARNG_STAT_ID = CAST(@ArngstatusChargeOff AS INT))
    AND (a.ACC_CLS_DT IS NULL AND a.ACC_CLS_TEAM_PRCS_CLS_DT IS NULL)
    AND a.ARNG_TYP_CD IN (SELECT value FROM @productCode)
    AND ip.PRMY_ARNG_IP_FL = 1
    AND ip.CAS_DOM_ID = @domainId 
    AND ip.PRMY_CAS_FL = 1
    AND a.CLS_RSN_TX IN (SELECT value FROM @clsqry)
    AND NOT EXISTS (
        SELECT 1 
        FROM ProductQueueAction pq 
        WHERE pq.ArngId = a.ARNG_ID
        AND pq.Action NOT IN (
            CAST(@AccountClosureInProgress AS INT),
            CAST(@AssistanceRequired AS INT),
            CAST(@LetterMailRequested AS INT),
            CAST(@AccountRestrictionRequested AS INT)
        )
        AND pq.IsDeleted = 0
    );
